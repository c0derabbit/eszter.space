<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friendly UIs: Let users copy with a click</title>
    <meta name="description" content="">
    <link rel="alternate" href="." type="application/atom+xml" title="">
    <link rel="alternate" href="." type="application/json" title="">
  </head>
  <body>
    <header>
      <h1><a href="/"></a></h1>
    </header>

    <main>
      <h1>Friendly UIs: Let users copy with a click</h1>

<p>There‚Äôs lots of subtle but very convenient features on GitHub‚Äôs UI, one of them is being able to copy stuff from an action menu. Let‚Äôs see how we can replicate that behaviour.</p>
<h2>When is this useful?</h2>
<p>One really good use case is GitHub‚Äôs links to specific lines in files ‚Äî generally places where it‚Äôs just not feasible to show all of them. (Imagine how littered it would look!)</p>
<p>It‚Äôs also a nice touch when you have something long to copy, and it‚Äôs not really convenient to select manually. Think product codes, long links with tokens or url params, and so forth.</p>
<h2>Using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document">Document API</a></h2>
<p><code>document</code> has much more to offer than <code>appendChild</code> and <code>getElementById</code>, just look at this looooong list, fresh from the console:</p>
<p><img src="/img/document-api.gif" alt=" "></p>
<p>Some of them are familiar, but this time we‚Äôll use one that‚Äôs a bit more obscure: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand"><code>document.execCommand</code></a>. It can manipulate editable elements (such as <code>input</code> and anything with the attribute <code>contentEditable</code>). <code>execCommand</code> takes at least one argument: the name of the command we‚Äôd like the browser to execute.</p>
<p>You can try <code>document.execCommand('otters')</code> of course (I have), it will simply return <code>false</code>.</p>
<h2>Let‚Äôs write some code!</h2>
<p>As mentioned, <code>execCommand</code> needs an editable element. This is because only editable elements can be selected programmatically. Let‚Äôs try with an <code>input</code>.</p>
<pre><code class="language-html">&lt;input
  id=&quot;some_id&quot;
  value=&quot;This will be on your clipboard, chicken and all üêì&quot;
  onclick=&quot;copyToClipboard()&quot;
/&gt;
</code></pre>
<p>To copy this text, an editable element must be selected. This can be done by:</p>
<ol>
<li>finding the element: <code>const element = document.getElementById('my-copiable-element')</code></li>
<li>selecting it: <code>element.select()</code></li>
</ol>
<pre><code class="language-js">function copyToClipboard() {
  const input = document.getElementById('some_id');
  input.select();
	document.execCommand('copy');
}
</code></pre>
<p>There, it should work already!</p>
<h2>But this is not really nice yet.</h2>
<p>To use this in production, this little snippet should meet a few more requirements:</p>
<ul>
<li>scalable (maybe we have a thousand elements, all copiable)</li>
<li>pretty.</li>
</ul>
<h3>Scalability</h3>
<p>We‚Äôll just make sure we can pass any <code>id</code> to <code>copyToClipboard</code>, like so:</p>
<pre><code class="language-js">function copyToClipboard(id) {
	const input = document.getElementById(id);
	input.select();
	document.execCommand('copy');
}
</code></pre>
<p><del>Done.</del> We‚Äôll have to change this function after the next bit, so hang tight.</p>
<h3>Looks</h3>
<p>We <em>could</em> style the <code>&lt;input&gt;</code>, but that‚Äôs not what we‚Äôll do. There‚Äôs a much more elegant solution, using any HTML element of choice plus a hidden <code>&lt;input&gt;</code>[^1]. Because <code>id</code>s should be unique, we‚Äôll make use of <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Howto/Use_data_attributes">data attributes</a>.</p>
<p>This would almost work, but hidden elements are not selectable. So we will use a <code>.hidden</code> class instead, only to visually hide the element.</p>
<p>This now is our final code:</p>
<pre><code class="language-html">&lt;div
  role=&quot;button&quot;
  class=&quot;copy-trigger&quot;
  data-copyid=&quot;my_uniq_id&quot;
  onclick=&quot;copyToClipboard&quot;
&gt;
  Copy text
&lt;/div&gt;
&lt;input
  class=&quot;hidden-copy-input&quot;
  id=&quot;my_uniq_id&quot;
  value=&quot;This will be on your clipboard, chicken and all üêì&quot;
/&gt;
</code></pre>
<pre><code class="language-css">.hidden-copy-input {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
}
</code></pre>
<pre><code class="language-js">const copyButtons = document.getElementsByClassName('copy-trigger');
copyButtons.forEach(btn =&gt; btn.addEventListener('click', copyToClipboard);

function copyToClipboard(e) {
  const id = e.target &amp;&amp; e.target.dataset &amp;&amp; e.target.dataset.copyid;
  const input = document.getElementById(id);
  input.select();
  document.execCommand('copy');
}
</code></pre>
<p>That‚Äôs it! If you want to be extra fancy, you can now show a message that it‚Äôs been copied. Questions? Just copy my email address from the sidebar and ask! :)</p>
<hr>
<h4>Notes</h4>
<p>[^1]: <code>&lt;input type=&quot;hidden&quot; ...&gt;</code> can be used to pass values in a form that we don‚Äôt want to display. However, they are by no means a secret!</p>


<hr>
<ul><li>Next: <a href="/async-map/">Async Array.map(): how to await an array with API calls for each item?</a></li><li>Previous: <a href="/gatsby-env-vars/">Environment variables with Gatsby and Netlify</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /copy-tooltip/ -->
  </body>
</html>
