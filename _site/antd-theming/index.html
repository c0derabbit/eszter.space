<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customising Ant Design theme in a create-react-app project</title>
    <meta name="description" content="">
    <link rel="alternate" href="." type="application/atom+xml" title="">
    <link rel="alternate" href="." type="application/json" title="">
  </head>
  <body>
    <header>
      <h1><a href="/"></a></h1>
    </header>

    <main>
      <h1>Customising Ant Design theme in a create-react-app project</h1>

<p>There comes a time in some developers’ life when they have to customize an <a href="https://ant.design">antd</a> theme. It’s <a href="https://ant.design/docs/react/customize-theme">kind of documented</a>, but tricky. Here’s a tl;dr.</p>
<h3>But first… why antd?</h3>
<p>Well, it looks like a very complete UI system. Creating your own is a lot of effort, so why not use something that’s out there and working perfectly? Of course, there are other alternatives, like <a href="https://material-ui.com/">Material UI</a> or <a href="https://evergreen.segment.com/">Evergreen</a>.</p>
<p>With that out of the way, let’s jump right in.</p>
<h2>CRA 2.0+ (most probably this is what you’ll need)</h2>
<pre><code class="language-sh">yarn add antd
yarn add @craco/craco craco-antd babel-plugin-import less less-loader
</code></pre>
<p>In <code>package.json</code>:</p>
<pre><code class="language-diff">-  &quot;start&quot;: &quot;react-scripts start&quot;,
-  &quot;build&quot;: &quot;react-scripts build&quot;,
+  &quot;start&quot;: &quot;craco start&quot;,
+  &quot;build&quot;: &quot;craco build&quot;,
</code></pre>
<p>In <code>App.(j|t)sx</code>:</p>
<pre><code class="language-js">import 'antd/dist/antd.less';
</code></pre>
<p>Create <code>craco.config.js</code> in root:</p>
<pre><code class="language-js">const CracoAntDesignPlugin = require('craco-antd');

process.env.BROWSER = 'none'; // optional, disables auto-open every time you restart

module.exports = {
  jest: {
    configure(config) {
      config.transformIgnorePatterns = [
        '/node_modules/(?!antd|rc-pagination|rc-calendar|rc-tooltip)/.+\\.js$',
      ];
      return config;
    },
  },
  plugins: [{ plugin: CracoAntDesignPlugin }],
};
</code></pre>
<h3>Theming</h3>
<p>Craco will pick up a theme from <code>antd.customize.less</code>.[^1]</p>
<pre><code class="language-less"> @primary-color: red;
</code></pre>
<h3>Live style reload</h3>
<p>Themes will not reload real-time by default. However, this is easy to solve with <strong>nodemon</strong>.</p>
<pre><code class="language-sh">yarn add -D nodemon
</code></pre>
<p>Update <code>package.json</code>:</p>
<pre><code class="language-diff">-  &quot;start&quot;: &quot;craco start&quot;,
+  &quot;start&quot;: &quot;nodemon -w craco.config.js -w ./antd.customize.less --exec 'craco start'&quot;,
</code></pre>
<h2>CRA Pre-2.0 (if your project is older)</h2>
<pre><code class="language-sh">yarn add antd
yarn add babel-plugin-import customize-cra less less-loader react-app-rewired
</code></pre>
<p>In <code>package.json</code>:</p>
<pre><code class="language-diff">-  &quot;start&quot;: &quot;react-scripts start&quot;,
-  &quot;build&quot;: &quot;react-scripts build&quot;,
-  &quot;test&quot;: &quot;react-scripts test&quot;,
+  &quot;start&quot;: &quot;react-app-rewired start&quot;,
+  &quot;build&quot;: &quot;react-app-rewired build&quot;,
+  &quot;test&quot;: react-app-rewired test&quot;,
</code></pre>
<p>In <code>App.(j|t)sx</code>:</p>
<pre><code class="language-js">import 'antd/dist/antd.less';
</code></pre>
<p>Create <code>config-overrides.js</code> in root:</p>
<pre><code class="language-js">const { override, fixBabelImports, addLessLoader } = require('customize-cra');

module.exports = override(
  fixBabelImports('import', {
    libraryName: 'antd',
    libraryDirectory: 'es',
    style: true,
  }),
  addLessLoader({
    javascriptEnabled: true,
    modifyVars: {
      '@primary-color': 'red',
    },
  }),
);
</code></pre>
<h3>Advanced theming</h3>
<p>Nobody in your team will look for themes in <code>config-overrides.js</code> however, so let’s extract the theme somewhere where it makes sense.</p>
<p>Create a <code>theme.js</code> with a simple object exported:</p>
<pre><code class="language-js">module.exports = {
  '@primary-color': 'red',
};
</code></pre>
<p>Now replace the theme changes in <code>config-overrides.js</code>:</p>
<pre><code class="language-diff">const { override, fixBabelImports, addLessLoader } = require('customize-cra');
+ const theme = require('./path/to/theme');

module.exports = override(
  ...
  addLessLoader({
    javascriptEnabled: true,
-    modifyVars: {
-      '@primary-color': 'red',
-    },
+    modifyVars: theme,
  }),
);
</code></pre>
<hr>
<h4>Notes</h4>
<p>[^1]: See all customisable variables <a href="https://github.com/ant-design/ant-design/blob/master/components/style/themes/default.less">here</a>.</p>


<hr>
<ul><li>Next: <a href="/games/">Curious games</a></li><li>Previous: <a href="/dark-mode/">Supporting dark mode on the web</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /antd-theming/ -->
  </body>
</html>
